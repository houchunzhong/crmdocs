# **订单佣金**  
## **一、模块概览**

“订单佣金”模块是 MIM CRM 的**交易级佣金审计中枢**，负责展示所有用户在不同交易平台上执行的每一笔订单所产生的佣金数据。通过此模块，管理员可以：

- ✅ 查看各平台订单的佣金计算结果  
- ✅ 识别并排查计算失败或异常的订单  
- ✅ 核对佣金是否正确计入代理账户  
- ✅ 支持多平台（MT5 / AQX / BO）统一管理  

> 🔐 仅限**管理员**或**财务主管**访问。所有数据均来自交易系统同步，确保真实可靠。

---

## **二、界面布局说明**

### **左侧导航菜单**
| 项目 | 功能 |
|------|------|
| **订单佣金** | 查看所有订单产生的佣金明细 |
| **佣金记录** | 查看各代理的累计佣金流水 |
| **佣金发放记录** | 查看已结算并支付的佣金历史 |

---

### **顶部标签页**
| 标签 | 说明 |
|------|------|
| **总览** | 返回上级页面 |
| **代理申请记录** | 查看待审核的代理申请 |
| **订单佣金** | 当前页面 |

---

## **三、核心功能详解**

### **1. 平台切换功能**

#### **功能描述**  
顶部提供三个平台选项卡：**MT5**、**AQX**、**BO**，允许用户按交易系统筛选订单佣金数据。

#### **平台说明**
| 平台 | 说明 |
|------|------|
| **MT5** | MetaTrader 5 交易终端，适用于主流外汇和差价合约（CFD）交易 |
| **AQX** | TradeWise 自研量化交易系统，支持高级策略与API接入 |
| **BO** | Back Office 交易系统，常用于机构客户或内部测试账户 |

> 💡 示例：若某代理主要使用 MT5，可在该标签下快速定位其交易行为与佣金表现。

---

### **2. 订单佣金主视图**

#### **功能描述**  
以表格形式展示指定平台下的所有交易订单及其对应的佣金信息，支持多种条件筛选与排序。

#### **字段说明**
| 字段 | 说明 |
|------|------|
| **交易单号** | 唯一订单编号（如 `10704`），点击可查看详情 |
| **交易用户** | 执行交易的用户ID（如 `16670`） |
| **交易账号** | 关联的交易账户名称（如 `500067 - MT5 - TradeWise`） |
| **交易品种** | 交易标的（如 `EURUSD`, `GBPUSD`, `USD/JPY`） |
| **交易量** | 开仓手数（如 `0.20`） |
| **平仓量** | 已平仓部分的手数（如 `0.00` 表示未平仓） |
| **订单总佣金** | 该订单应生成的总佣金金额（若显示 `--` 表示尚未计算） |
| **交易时间** | 订单执行的时间戳（精确到秒） |
| **价位** | 成交价格（如 `1.18579`） |
| **用户佣金** | 分配给用户的实际佣金（通常为0，除非配置了用户返佣） |
| **库存费** | 持仓过夜费用（多数情况下为0） |
| **交易盈亏** | 该笔交易的浮动盈亏（红色表示亏损，绿色表示盈利） |

#### **状态标识**
- ✅ **绿色圆圈 ✓**：计算成功，佣金正常生成  
- ❌ **红色圆圈 !**：计算失败，需人工干预  
- 🟡 **黄色方框 □**：待处理或警告状态  

> ⚠️ 示例：订单 `10702` 显示“计算失败”，提示错误：“order ticket id: 184 symbol: EURUSD not in rebate type”，表明该交易品种未被纳入佣金规则范围。

---

### **3. 筛选与搜索功能**

#### **功能描述**  
提供多维度查询条件，帮助用户快速定位目标订单。

#### **筛选器说明**
| 控件 | 功能 |
|------|------|
| **计算情况** | 过滤计算状态：全部、成功、失败、待处理 |
| **交易时间从 ~ 到** | 设置时间区间，如“2026-01-01 至 2026-02-28” |
| **交易用户 查询** | 输入用户ID或姓名进行筛选 |
| **交易账户 查询** | 按交易账户名过滤 |
| **交易单号 查询** | 直接输入订单号查找 |

> 💡 建议：结合“计算失败”筛选 + 时间范围，定期排查系统异常。

---

## **四、常见问题与解决方案**

### **Q1：为什么某些订单的“订单总佣金”显示为 `--`？**  
- ❌ 可能原因：  
  - 订单仍在处理中（未完成结算）  
  - 交易系统尚未推送完整数据  
  - 该交易品种暂无佣金规则配置  

> ✅ 解决方案：等待系统同步完成；或检查“等级与佣金”模块中的佣金方案设置。

---

### **Q2：如何修复“计算失败”的订单？**  
- ✅ 步骤如下：  
  1. 在“订单佣金”列表中找到失败订单（如 `10702`）  
  2. 查看错误提示（如“not in rebate type”）  
  3. 登录 **等级与佣金 → 佣金方案** 配置页面  
  4. 添加缺失的交易品种（如 `EURUSD`）至对应佣金计划  
  5. 重新触发计算流程（系统自动重试或手动刷新）

---

### **Q3：用户佣金为何始终为0？**  
- ✅ 设计逻辑：默认情况下，佣金归代理所有，用户个人不参与分成。  
- 若需设置用户返佣（如客户奖励），需在“等级与佣金”中启用“用户返佣比例”。

---

### **Q4：能否导出订单佣金数据？**  
- ❌ 当前版本不支持直接导出。  
- ✅ 替代方案：复制表格内容或使用 API 接口批量获取（需技术支持）。

---

## **五、最佳实践建议**

| 场景 | 推荐做法 |
|------|----------|
| **日常监控** | 每日检查“计算失败”订单，确保系统稳定运行 |
| **异常排查** | 定期筛选“计算失败”记录，分析错误模式（如特定品种、平台） |
| **规则验证** | 新增佣金方案后，立即在本模块验证是否生效 |
| **跨平台对比** | 对比 MT5、AQX、BO 各平台的佣金分布，评估策略有效性 |
| **合规审计** | 将本模块数据作为佣金结算的原始凭证，供财务核对 |

---

## **六、总结**

“订单佣金”模块实现了对交易级佣金生成过程的透明化管理。通过按平台分类、实时展示计算结果与异常预警，管理员能够及时发现并解决系统问题，确保佣金准确无误地分配至代理账户。它是连接交易行为与收益激励的关键桥梁，支撑着整个代理生态的公平与高效运作。

✅ **推荐操作流程**：  
1. 进入“订单佣金” → 2. 选择平台（如 MT5）→ 3. 使用筛选器定位“计算失败”订单 → 4. 查看错误详情 → 5. 调整佣金方案或通知技术团队 → 6. 验证修复效果

> 📌 所有数据均为系统自动同步，真实反映交易行为与佣金逻辑，是财务对账与系统维护的重要依据。

---

**版本：v1.0**  
**最后更新：2026年2月**