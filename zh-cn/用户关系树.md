# **用户关系树**

## **一、模块概览**

“用户关系树”模块是 MIM CRM 的**组织架构可视化中枢**，通过树状图形式直观呈现所有用户的上下级关系。它不仅展示代理（IB）、客户（Client）等角色间的层级结构，还集成关键财务与身份验证信息，便于管理员进行：

- ✅ 用户关系溯源
- ✅ 代理业绩评估
- ✅ KYC 审核状态跟踪
- ✅ 交易行为监控

> 🔍 所有数据实时同步，支持按 ID、姓名、手机号或邮箱搜索，确保高效定位目标用户。

---

## **二、界面布局说明**

### **左侧导航菜单**

| 项目                  | 功能                         |
| --------------------- | ---------------------------- |
| **用户查询**    | 快速查找特定用户             |
| **用户列表**    | 查看所有用户基本信息         |
| **用户关系树**  | 展示用户层级结构（核心功能） |
| **CFD用户列表** | 显示 CFD 平台用户            |
| **BO用户列表**  | 显示 BO 平台用户             |

---

### **顶部标签页**

| 标签                    | 说明               |
| ----------------------- | ------------------ |
| **总览**          | 返回上级页面       |
| **用户关系树**    | 当前页面           |
| **用户 - [姓名]** | 进入特定用户详情页 |

---

## **三、核心功能详解**

### **1. 用户关系树主视图**

#### **功能描述**

以树形结构展示用户之间的推荐/代理关系，每个节点代表一个用户，父子节点表示上下级关系。支持展开/折叠子节点，查看完整层级链条。

#### **字段说明**

| 字段                | 说明                     |
| ------------------- | ------------------------ |
| **头像/图标** | 用户头像；特殊标记如下： |

- 🟨 **红色星标**：高风险用户（如KYC拒绝）
- 🟩 **绿色勾**：已验证账户
- 🔴 **红色感叹号**：审核被拒或异常状态| **用户名/姓名** | 用户显示名（可为中文、英文、韩文等多语言） |
  | **ID** | 系统唯一用户编号（如 `16672`） |
  | **KYC状态图标** |
- ✅ **绿色 ✓**：已验证（Verified）
- ⚠️ **橙色 !**：待审核（Pending）
- ❌ **红色 !**：被拒绝（Rejected） |
  | **资产列** | 显示该用户的资金状况：
- 💰 **总入金**：累计充值金额
- 💸 **总出金**：累计提现金额
- 🧾 **总资产**：当前可用余额 + 已冻结资金
- 💵 **可用余额**：可自由交易的资金 |
  | **用户类型** |
- 🏢 **IB**：独立经纪人（Independent Broker）
- 👤 **Verified Client**：已验证客户
- 🆘 **New Client**：新注册客户
- 🧑‍💼 **Client**：普通客户 |
  | **下级用户数量** | 该用户直接推荐的下属人数（如 “27” 表示有 27 名下级） |
  | **查看按钮** | 点击进入该用户的**个人详情页** |

#### **交互操作**

- 🔎 **搜索框**：输入 `ID`、`姓名`、`手机号` 或 `邮箱` 即可全局检索。
- ▼ **展开/折叠**：点击左侧三角图标展开或收起某用户的子级列表。
- 📊 **层级浏览**：从顶级 IB 开始向下逐层查看其代理网络。

> 💡 示例：若某 IB 下辖 30+ 客户，可通过此视图快速识别其业务规模与活跃度。

---

### **2. 用户详情页（User Profile）**

#### **功能描述**

点击任一用户右侧的 **“查看”** 按钮，即可进入其详细资料页面，全面掌握该用户的基本信息、账户状态、交易记录及操作日志。

#### **页面结构**

##### **左侧信息栏**

| 字段                        | 说明                                            |
| --------------------------- | ----------------------------------------------- |
| **头像 & 姓名**       | 用户头像与全名                                  |
| **ID & 角色**         | 用户编号与类型（如 IB / Verified Client）       |
| **总入金 / 总出金**   | 累计资金流动总额                                |
| **总资产 / 可用余额** | 实时资产快照                                    |
| **国籍 / 居住地**     | 地理位置信息                                    |
| **注册时间**          | 账户创建时间                                    |
| **联系方式**          | 手机号与邮箱，附带验证状态图标（✅ 表示已验证） |

##### **右侧内容区（Tab 切换）**

| Tab                | 内容                                         |
| ------------------ | -------------------------------------------- |
| **用户资料** | 编辑姓名、国籍、生日、邮箱、手机号等个人信息 |
| **用户资产** | 查看各币种余额、出入金历史                   |
| **交易账户** | 列出关联的 MT5、BO、AQX 等交易账号           |
| **出金账户** | 查看绑定的银行、钱包等提现方式               |
| **日志**     | 记录登录、修改、资金变动等系统操作           |

#### **关键字段说明**

| 字段                        | 说明                                    |
| --------------------------- | --------------------------------------- |
| **双因素身份认证**    | 是否启用 2FA（如 Google Authenticator） |
| **上级用户ID / 姓名** | 指明该用户的推荐人（即上级）            |
| **下级用户数量**      | 直接推荐的用户总数                      |
| **用户邀请码**        | 该用户生成的推广链接或代码              |
| **用户邀请链接**      | 可复制的专属推广 URL                    |

> ✅ 示例：在 Akina Akiyama 的详情页中，可看到她是由 ID:1 的用户推荐，并拥有 6 名下级客户，符合典型的代理发展模式。

---

### **3. KYC 审核状态标识**

#### **功能描述**

通过颜色编码的图标清晰展示每位用户的 KYC（Know Your Customer）审核结果，帮助管理员快速识别风险用户。

| 图标                 | 含义               | 风险等级    |
| -------------------- | ------------------ | ----------- |
| 🟩**绿色 ✓**  | 已验证（Verified） | ✅ 低风险   |
| ⚠️**橙色 !** | 待审核（Pending）  | ⚠️ 中风险 |
| ❌**红色 !**   | 被拒绝（Rejected） | 🔴 高风险   |

> 🔍 提示：红色感叹号用户可能涉及虚假信息、证件不符或黑名单匹配，需重点审查。

---

### **4. 代理层级与佣金逻辑（隐含功能）**

虽然未直接显示，但“用户关系树”是计算**代理佣金**的基础。系统根据以下规则自动分配收益：

- **上级代理**：从其下级客户的**入金**中获取一定比例佣金（如 1%）
- **多级分销**：部分平台支持二级甚至三级返佣（需在“等级与佣金”模块配置）
- **结算周期**：通常按日/周/月结算，资金打入代理的“出金账户”

> 💡 示例：若 Akina Akiyama 是 IB，且其下级客户入金 1,000 USD，则她可能获得 10 USD 佣金（假设费率 1%）。

---

## **四、最佳实践建议**

| 场景                 | 推荐做法                                                   |
| -------------------- | ---------------------------------------------------------- |
| **新用户注册** | 在“用户关系树”中确认其上级是否有效，防止非法推荐         |
| **KYC 审核**   | 优先处理带有橙色感叹号的用户，避免合规风险                 |
| **代理考核**   | 定期查看 IB 的“下级用户数量”与“总入金”，评估其招募能力 |
| **风险控制**   | 对红色感叹号用户立即暂停交易权限，并通知法务团队           |
| **客户维护**   | 通过“用户详情页”了解客户偏好，提供个性化服务             |

---

## **五、常见问题解答（FAQ）**

### **Q1：如何找到某个用户的上级？**

- 在“用户关系树”中点击该用户 → 进入详情页 → 查看 **“上级用户ID”** 和 **“上级用户姓名”**。

### **Q2：为什么某些用户没有下级？**

- 因为他们是终端客户（Client），不具有推荐权限；或尚未成功邀请他人。

### **Q3：能否导出用户关系树？**

- ❌ 当前版本不支持直接导出树形结构。但可在“用户列表”中导出 CSV，再通过 Excel 构建层级关系。

### **Q4：如何批量处理多个用户？**

- ❌ 不支持批量操作。建议使用“用户列表”进行筛选后逐一处理。

### **Q5：用户关系树会自动更新吗？**

- ✅ 是的。每次用户注册、推荐或状态变更时，系统会实时同步至关系树。

---

## **六、总结**

“用户关系树”模块将复杂的用户网络转化为可视化的层级结构，极大提升了客户管理效率与合规性。通过结合 KYC 状态、资金数据与代理关系，管理员不仅能快速定位目标用户，还能深入分析代理生态，优化激励机制与风险管理策略。

✅ **推荐操作流程**：

1. 使用搜索框定位目标用户 → 2. 查看其在关系树中的位置 → 3. 进入详情页核实信息 → 4. 根据状态决定下一步操作（如审核、联系、停用）

> 📌 所有操作均记录于系统日志，确保过程可追溯、决策有依据。

---

**版本：v1.0**
**最后更新：2026年2月**
